!function(){"use strict";var e={3905:function(e,t,r){var n=r(4055);n.createWebSocketStream=r(8892),n.Server=r(8912),n.Receiver=r(985),n.Sender=r(4880),e.exports=n},105:function(e,t,r){r(2518),r(2905),r(4381);var n=r(7540).EMPTY_BUFFER;function o(e,t){if(0===e.length)return n;if(1===e.length)return e[0];for(var r=Buffer.allocUnsafe(t),o=0,i=0;i<e.length;i++){var s=e[i];r.set(s,o),o+=s.length}return o<t?r.slice(0,o):r}function i(e,t,r,n,o){for(var i=0;i<o;i++)r[n+i]=e[i]^t[3&i]}function s(e,t){for(var r=e.length,n=0;n<r;n++)e[n]^=t[3&n]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){return c.readOnly=!0,Buffer.isBuffer(e)?e:(e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),c.readOnly=!1),t);var t}try{var u=r(6772),f=u.BufferUtil||u;e.exports={concat:o,mask:function(e,t,r,n,o){o<48?i(e,t,r,n,o):f.mask(e,t,r,n,o)},toArrayBuffer:a,toBuffer:c,unmask:function(e,t){e.length<32?s(e,t):f.unmask(e,t)}}}catch(t){e.exports={concat:o,mask:i,toArrayBuffer:a,toBuffer:c,unmask:s}}},7540:function(e,t,r){r(3920),r(9350),r(4381),e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:function(){}}},3742:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return a(this,r)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r(6785),r(2646),r(3920),r(9350),r(4381),r(7507),r(9718),r(4647),r(8536);var f=function e(t,r){u(this,e),this.target=r,this.type=t},l=function(e){o(r,e);var t=s(r);function r(e,n){var o;return u(this,r),(o=t.call(this,"message",n)).data=e,o}return r}(f),h=function(e){o(r,e);var t=s(r);function r(e,n,o){var i;return u(this,r),(i=t.call(this,"close",o)).wasClean=o._closeFrameReceived&&o._closeFrameSent,i.reason=n,i.code=e,i}return r}(f),d=function(e){o(r,e);var t=s(r);function r(e){return u(this,r),t.call(this,"open",e)}return r}(f),p=function(e){o(r,e);var t=s(r);function r(e,n){var o;return u(this,r),(o=t.call(this,"error",n)).message=e.message,o.error=e,o}return r}(f),y={addEventListener:function(e,t,r){if("function"==typeof t){var n=r&&r.once?"once":"on";"message"===e?(o._listener=t,this[n](e,o)):"close"===e?(i._listener=t,this[n](e,i)):"error"===e?(s._listener=t,this[n](e,s)):"open"===e?(a._listener=t,this[n](e,a)):this[n](e,t)}function o(e){t.call(this,new l(e,this))}function i(e,r){t.call(this,new h(e,r,this))}function s(e){t.call(this,new p(e,this))}function a(){t.call(this,new d(this))}},removeEventListener:function(e,t){for(var r=this.listeners(e),n=0;n<r.length;n++)r[n]!==t&&r[n]._listener!==t||this.removeListener(e,r[n])}};e.exports=y},6497:function(e,t,r){r(2518),r(5575),r(2076),r(9983),r(720),r(7493),r(2794);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function o(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map((function(t){var r=e[t];return Array.isArray(r)||(r=[r]),r.map((function(e){return[t].concat(Object.keys(e).map((function(t){var r=e[t];return Array.isArray(r)||(r=[r]),r.map((function(e){return!0===e?t:"".concat(t,"=").concat(e)})).join("; ")}))).join("; ")})).join(", ")})).join(", ")},parse:function(e){var t=Object.create(null);if(void 0===e||""===e)return t;for(var r,i,s=Object.create(null),a=!1,c=!1,u=!1,f=-1,l=-1,h=0;h<e.length;h++){var d=e.charCodeAt(h);if(void 0===r)if(-1===l&&1===n[d])-1===f&&(f=h);else if(32===d||9===d)-1===l&&-1!==f&&(l=h);else{if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index ".concat(h));if(-1===f)throw new SyntaxError("Unexpected character at index ".concat(h));-1===l&&(l=h);var p=e.slice(f,l);44===d?(o(t,p,s),s=Object.create(null)):r=p,f=l=-1}else if(void 0===i)if(-1===l&&1===n[d])-1===f&&(f=h);else if(32===d||9===d)-1===l&&-1!==f&&(l=h);else if(59===d||44===d){if(-1===f)throw new SyntaxError("Unexpected character at index ".concat(h));-1===l&&(l=h),o(s,e.slice(f,l),!0),44===d&&(o(t,r,s),s=Object.create(null),r=void 0),f=l=-1}else{if(61!==d||-1===f||-1!==l)throw new SyntaxError("Unexpected character at index ".concat(h));i=e.slice(f,h),f=l=-1}else if(c){if(1!==n[d])throw new SyntaxError("Unexpected character at index ".concat(h));-1===f?f=h:a||(a=!0),c=!1}else if(u)if(1===n[d])-1===f&&(f=h);else if(34===d&&-1!==f)u=!1,l=h;else{if(92!==d)throw new SyntaxError("Unexpected character at index ".concat(h));c=!0}else if(34===d&&61===e.charCodeAt(h-1))u=!0;else if(-1===l&&1===n[d])-1===f&&(f=h);else if(-1===f||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError("Unexpected character at index ".concat(h));if(-1===f)throw new SyntaxError("Unexpected character at index ".concat(h));-1===l&&(l=h);var y=e.slice(f,l);a&&(y=y.replace(/\\/g,""),a=!1),o(s,i,y),44===d&&(o(t,r,s),s=Object.create(null),r=void 0),i=void 0,f=l=-1}else-1===l&&(l=h)}if(-1===f||u)throw new SyntaxError("Unexpected end of input");-1===l&&(l=h);var _=e.slice(f,l);return void 0===r?o(t,_,s):(void 0===i?o(s,_,!0):o(s,i,a?_.replace(/\\/g,""):_),o(t,r,s)),t}}},8589:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(3920),r(9350),r(4381);var o=Symbol("kDone"),i=Symbol("kRun"),s=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this[o]=function(){r.pending--,r[i]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}var t,r,s;return t=e,(r=[{key:"add",value:function(e){this.jobs.push(e),this[i]()}},{key:i,value:function(){if(this.pending!==this.concurrency&&this.jobs.length){var e=this.jobs.shift();this.pending++,e(this[o])}}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},9548:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(3920),r(9350),r(4381),r(389),r(8390),r(7493),r(3204),r(7099),r(2794),r(2518),r(1714),r(92),r(9436);var a,c=r(8761),u=r(105),f=r(8589),l=r(7540),h=l.kStatusCode,d=l.NOOP,p=Buffer.from([0,0,255,255]),y=Symbol("permessage-deflate"),_=Symbol("total-length"),m=Symbol("callback"),v=Symbol("buffers"),b=Symbol("error"),g=function(){function e(t,r,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._maxPayload=0|n,this._options=t||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!a){var o=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;a=new f(o)}}var t,r,n;return t=e,n=[{key:"extensionName",get:function(){return"permessage-deflate"}}],(r=[{key:"offer",value:function(){var e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}},{key:"accept",value:function(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}},{key:"cleanup",value:function(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){var e=this._deflate[m];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}},{key:"acceptAsServer",value:function(e){var t=this._options,r=e.find((function(e){return!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)}));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}},{key:"acceptAsClient",value:function(e){var t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}},{key:"normalizeParams",value:function(e){var t=this;return e.forEach((function(e){Object.keys(e).forEach((function(r){var n=e[r];if(n.length>1)throw new Error('Parameter "'.concat(r,'" must have only a single value'));if(n=n[0],"client_max_window_bits"===r){if(!0!==n){var o=+n;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n));n=o}else if(!t._isServer)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n))}else if("server_max_window_bits"===r){var i=+n;if(!Number.isInteger(i)||i<8||i>15)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n));n=i}else{if("client_no_context_takeover"!==r&&"server_no_context_takeover"!==r)throw new Error('Unknown parameter "'.concat(r,'"'));if(!0!==n)throw new TypeError('Invalid value for parameter "'.concat(r,'": ').concat(n))}e[r]=n}))})),e}},{key:"decompress",value:function(e,t,r){var n=this;a.add((function(o){n._decompress(e,t,(function(e,t){o(),r(e,t)}))}))}},{key:"compress",value:function(e,t,r){var n=this;a.add((function(o){n._compress(e,t,(function(e,t){o(),r(e,t)}))}))}},{key:"_decompress",value:function(e,t,r){var n=this,i=this._isServer?"client":"server";if(!this._inflate){var s="".concat(i,"_max_window_bits"),a="number"!=typeof this.params[s]?c.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=c.createInflateRaw(o(o({},this._options.zlibInflateOptions),{},{windowBits:a})),this._inflate[y]=this,this._inflate[_]=0,this._inflate[v]=[],this._inflate.on("error",j),this._inflate.on("data",x)}this._inflate[m]=r,this._inflate.write(e),t&&this._inflate.write(p),this._inflate.flush((function(){var e=n._inflate[b];if(e)return n._inflate.close(),n._inflate=null,void r(e);var o=u.concat(n._inflate[v],n._inflate[_]);n._inflate._readableState.endEmitted?(n._inflate.close(),n._inflate=null):(n._inflate[_]=0,n._inflate[v]=[],t&&n.params["".concat(i,"_no_context_takeover")]&&n._inflate.reset()),r(null,o)}))}},{key:"_compress",value:function(e,t,r){var n=this,i=this._isServer?"server":"client";if(!this._deflate){var s="".concat(i,"_max_window_bits"),a="number"!=typeof this.params[s]?c.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=c.createDeflateRaw(o(o({},this._options.zlibDeflateOptions),{},{windowBits:a})),this._deflate[_]=0,this._deflate[v]=[],this._deflate.on("error",d),this._deflate.on("data",w)}this._deflate[m]=r,this._deflate.write(e),this._deflate.flush(c.Z_SYNC_FLUSH,(function(){if(n._deflate){var e=u.concat(n._deflate[v],n._deflate[_]);t&&(e=e.slice(0,e.length-4)),n._deflate[m]=null,n._deflate[_]=0,n._deflate[v]=[],t&&n.params["".concat(i,"_no_context_takeover")]&&n._deflate.reset(),r(null,e)}}))}}])&&s(t.prototype,r),n&&s(t,n),e}();function w(e){this[v].push(e),this[_]+=e.length}function x(e){this[_]+=e.length,this[y]._maxPayload<1||this[_]<=this[y]._maxPayload?this[v].push(e):(this[b]=new RangeError("Max payload size exceeded"),this[b][h]=1009,this.removeListener("data",x),this.reset())}function j(e){this[y]._inflate=null,e[h]=1007,this[m](e)}e.exports=g},985:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return a(this,r)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(2794),r(2518),r(873),r(3062),r(3233),r(9893),r(1792),r(1487),r(8301),r(6233),r(6286),r(8886),r(5410),r(7690),r(2495),r(4954),r(4260),r(1250),r(7580),r(9046),r(7419),r(7911),r(8876),r(3925),r(1949),r(6026),r(4381),r(4647),r(8655),r(6785),r(2646),r(3920),r(9350),r(7507),r(9718),r(8536);var u=r(2413).Writable,f=r(9548),l=r(7540),h=l.BINARY_TYPES,d=l.EMPTY_BUFFER,p=l.kStatusCode,y=l.kWebSocket,_=r(105),m=_.concat,v=_.toArrayBuffer,b=_.unmask,g=r(5266),w=g.isValidStatusCode,x=g.isValidUTF8,j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,a=s(c);function c(e,t,r,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(o=a.call(this))._binaryType=e||h[0],o[y]=void 0,o._extensions=t||{},o._isServer=!!r,o._maxPayload=0|n,o._bufferedBytes=0,o._buffers=[],o._compressed=!1,o._payloadLength=0,o._mask=void 0,o._fragmented=0,o._masked=!1,o._fin=!1,o._opcode=0,o._totalPayloadLength=0,o._messageLength=0,o._fragments=[],o._state=0,o._loop=!1,o}return t=c,(r=[{key:"_write",value:function(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}},{key:"consume",value:function(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){var t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}var r=Buffer.allocUnsafe(e);do{var n=this._buffers[0],o=r.length-e;e>=n.length?r.set(this._buffers.shift(),o):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),o),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return r}},{key:"startLoop",value:function(e){var t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}},{key:"getInfo",value:function(){if(this._bufferedBytes<2)this._loop=!1;else{var e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,k(RangeError,"RSV2 and RSV3 must be clear",!0,1002);var t=64==(64&e[0]);if(t&&!this._extensions[f.extensionName])return this._loop=!1,k(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,k(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,k(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,k(RangeError,"invalid opcode ".concat(this._opcode),!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,k(RangeError,"invalid opcode ".concat(this._opcode),!0,1002);if(!this._fin)return this._loop=!1,k(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,k(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,k(RangeError,"invalid payload length ".concat(this._payloadLength),!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,k(RangeError,"MASK must be set",!0,1002)}else if(this._masked)return this._loop=!1,k(RangeError,"MASK must be clear",!0,1002);if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}}},{key:"getPayloadLength16",value:function(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}},{key:"getPayloadLength64",value:function(){if(!(this._bufferedBytes<8)){var e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,k(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}this._loop=!1}},{key:"haveLength",value:function(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,k(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=3:this._state=4}},{key:"getMask",value:function(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}},{key:"getData",value:function(e){var t=d;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&b(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}},{key:"decompress",value:function(e,t){var r=this;this._extensions[f.extensionName].decompress(e,this._fin,(function(e,n){if(e)return t(e);if(n.length){if(r._messageLength+=n.length,r._messageLength>r._maxPayload&&r._maxPayload>0)return t(k(RangeError,"Max payload size exceeded",!1,1009));r._fragments.push(n)}var o=r.dataMessage();if(o)return t(o);r.startLoop(t)}))}},{key:"dataMessage",value:function(){if(this._fin){var e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var r;r="nodebuffer"===this._binaryType?m(t,e):"arraybuffer"===this._binaryType?v(m(t,e)):t,this.emit("message",r)}else{var n=m(t,e);if(!x(n))return this._loop=!1,k(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",n.toString())}}this._state=0}},{key:"controlMessage",value:function(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return k(RangeError,"invalid payload length 1",!0,1002);var t=e.readUInt16BE(0);if(!w(t))return k(RangeError,"invalid status code ".concat(t),!0,1002);var r=e.slice(2);if(!x(r))return k(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,r.toString()),this.end()}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}])&&o(t.prototype,r),n&&o(t,n),c}(u);function k(e,t,r,n){var o=new e(r?"Invalid WebSocket frame: ".concat(t):t);return Error.captureStackTrace(o,k),o[p]=n,o}e.exports=j},4880:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(9747),r(2518);var o=r(6417).randomFillSync,i=r(9548),s=r(7540).EMPTY_BUFFER,a=r(5266).isValidStatusCode,c=r(105),u=c.mask,f=c.toBuffer,l=Buffer.alloc(4),h=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._extensions=r||{},this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}var t,r,c;return t=e,c=[{key:"frame",value:function(e,t){var r=t.mask&&t.readOnly,n=t.mask?6:2,i=e.length;e.length>=65536?(n+=8,i=127):e.length>125&&(n+=2,i=126);var s=Buffer.allocUnsafe(r?e.length+n:n);return s[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(s[0]|=64),s[1]=i,126===i?s.writeUInt16BE(e.length,2):127===i&&(s.writeUInt32BE(0,2),s.writeUInt32BE(e.length,6)),t.mask?(o(l,0,4),s[1]|=128,s[n-4]=l[0],s[n-3]=l[1],s[n-2]=l[2],s[n-1]=l[3],r?(u(e,l,s,n,e.length),[s]):(u(e,l,e,0,e.length),[s,e])):[s,e]}}],(r=[{key:"close",value:function(e,t,r,n){var o;if(void 0===e)o=s;else{if("number"!=typeof e||!a(e))throw new TypeError("First argument must be a valid error code number");if(void 0===t||""===t)(o=Buffer.allocUnsafe(2)).writeUInt16BE(e,0);else{var i=Buffer.byteLength(t);if(i>123)throw new RangeError("The message must not be greater than 123 bytes");(o=Buffer.allocUnsafe(2+i)).writeUInt16BE(e,0),o.write(t,2)}}this._deflating?this.enqueue([this.doClose,o,r,n]):this.doClose(o,r,n)}},{key:"doClose",value:function(t,r,n){this.sendFrame(e.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:r,readOnly:!1}),n)}},{key:"ping",value:function(e,t,r){var n=f(e);if(n.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,n,t,f.readOnly,r]):this.doPing(n,t,f.readOnly,r)}},{key:"doPing",value:function(t,r,n,o){this.sendFrame(e.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:r,readOnly:n}),o)}},{key:"pong",value:function(e,t,r){var n=f(e);if(n.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,n,t,f.readOnly,r]):this.doPong(n,t,f.readOnly,r)}},{key:"doPong",value:function(t,r,n,o){this.sendFrame(e.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:r,readOnly:n}),o)}},{key:"send",value:function(t,r,n){var o=f(t),s=this._extensions[i.extensionName],a=r.binary?2:1,c=r.compress;if(this._firstFragment?(this._firstFragment=!1,c&&s&&(c=o.length>=s._threshold),this._compress=c):(c=!1,a=0),r.fin&&(this._firstFragment=!0),s){var u={fin:r.fin,rsv1:c,opcode:a,mask:r.mask,readOnly:f.readOnly};this._deflating?this.enqueue([this.dispatch,o,this._compress,u,n]):this.dispatch(o,this._compress,u,n)}else this.sendFrame(e.frame(o,{fin:r.fin,rsv1:!1,opcode:a,mask:r.mask,readOnly:f.readOnly}),n)}},{key:"dispatch",value:function(t,r,n,o){var s=this;if(r){var a=this._extensions[i.extensionName];this._bufferedBytes+=t.length,this._deflating=!0,a.compress(t,n.fin,(function(r,i){if(s._socket.destroyed){var a=new Error("The socket was closed while data was being compressed");"function"==typeof o&&o(a);for(var c=0;c<s._queue.length;c++){var u=s._queue[c][4];"function"==typeof u&&u(a)}}else s._bufferedBytes-=t.length,s._deflating=!1,n.readOnly=!1,s.sendFrame(e.frame(i,n),o),s.dequeue()}))}else this.sendFrame(e.frame(t,n),o)}},{key:"dequeue",value:function(){for(;!this._deflating&&this._queue.length;){var e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}},{key:"enqueue",value:function(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}},{key:"sendFrame",value:function(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}])&&n(t.prototype,r),c&&n(t,c),e}();e.exports=h},8892:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(7493),r(3920),r(1714),r(92),r(8390),r(9436);var s=r(2413).Duplex;function a(e){e.emit("close")}function c(){!this.destroyed&&this._writableState.finished&&this.destroy()}function u(e){this.removeListener("error",u),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){var r=!0;function n(){r&&e._socket.resume()}e.readyState===e.CONNECTING?e.once("open",(function(){e._receiver.removeAllListeners("drain"),e._receiver.on("drain",n)})):(e._receiver.removeAllListeners("drain"),e._receiver.on("drain",n));var i=new s(o(o({},t),{},{autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1}));return e.on("message",(function(t){i.push(t)||(r=!1,e._socket.pause())})),e.once("error",(function(e){i.destroyed||i.destroy(e)})),e.once("close",(function(){i.destroyed||i.push(null)})),i._destroy=function(t,r){if(e.readyState===e.CLOSED)return r(t),void process.nextTick(a,i);var n=!1;e.once("error",(function(e){n=!0,r(e)})),e.once("close",(function(){n||r(t),process.nextTick(a,i)})),e.terminate()},i._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),i._readableState.endEmitted&&i.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){i._final(t)}))},i._read=function(){e.readyState!==e.OPEN||r||(r=!0,e._receiver._writableState.needDrain||e._socket.resume())},i._write=function(t,r,n){e.readyState!==e.CONNECTING?e.send(t,n):e.once("open",(function(){i._write(t,r,n)}))},i.on("end",c),i.on("error",u),i}},5266:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(3920),r(9350),r(4381),r(7507),r(9718),r(4647),r(8536);try{var o=r(6993);t.isValidUTF8="object"===n(o)?o.Validation.isValidUTF8:o}catch(e){t.isValidUTF8=function(){return!0}}t.isValidStatusCode=function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999}},8912:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw s}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(5538),r(4381),r(9718),r(4647),r(8536),r(946),r(2518),r(8588),r(3938),r(2076),r(9983),r(2794),r(6785),r(7493),r(720),r(2646),r(3920),r(1714),r(92),r(8390),r(9436),r(4165),r(8282),r(9350),r(7507);var y=r(8614),_=r(6417).createHash,m=r(8605),v=m.createServer,b=m.STATUS_CODES,g=r(9548),w=r(4055),x=r(6497),j=x.format,k=x.parse,S=r(7540),O=S.GUID,E=S.kWebSocket,P=/^[+/0-9A-Za-z]{22}==$/,C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,r,n,i=l(s);function s(e,t){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r=i.call(this),null==(e=a({maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},e)).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(r._server=v((function(e,t){var r=b[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)})),r._server.listen(e.port,e.host,e.backlog,t)):e.server&&(r._server=e.server),r._server){var n=r.emit.bind(d(r),"connection");r._removeListeners=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e.on(o,t[o])}return function(){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e.removeListener(o,t[o])}}}(r._server,{listening:r.emit.bind(d(r),"listening"),error:r.emit.bind(d(r),"error"),upgrade:function(e,t,o){r.handleUpgrade(e,t,o,n)}})}return!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(r.clients=new Set),r.options=e,r}return t=s,(r=[{key:"address",value:function(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}},{key:"close",value:function(e){var t=this;if(e&&this.once("close",e),this.clients){var r,n=o(this.clients);try{for(n.s();!(r=n.n()).done;)r.value.terminate()}catch(e){n.e(e)}finally{n.f()}}var i=this._server;i&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?i.close((function(){return t.emit("close")})):process.nextTick(N,this)}},{key:"shouldHandle",value:function(e){if(this.options.path){var t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}},{key:"handleUpgrade",value:function(e,t,r,n){var o=this;t.on("error",T);var i=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),s=+e.headers["sec-websocket-version"],a={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!i||!P.test(i)||8!==s&&13!==s||!this.shouldHandle(e))return q(t,400);if(this.options.perMessageDeflate){var c=new g(this.options.perMessageDeflate,!0,this.options.maxPayload);try{var u=k(e.headers["sec-websocket-extensions"]);u[g.extensionName]&&(c.accept(u[g.extensionName]),a[g.extensionName]=c)}catch(e){return q(t,400)}}if(this.options.verifyClient){var f={origin:e.headers["".concat(8===s?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(function(s,c,u,f){if(!s)return q(t,c||401,u,f);o.completeUpgrade(i,a,e,t,r,n)}));if(!this.options.verifyClient(f))return q(t,401)}this.completeUpgrade(i,a,e,t,r,n)}},{key:"completeUpgrade",value:function(e,t,r,n,o,i){var s=this;if(!n.readable||!n.writable)return n.destroy();if(n[E])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");var a=_("sha1").update(e+O).digest("base64"),u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: ".concat(a)],f=new w(null),l=r.headers["sec-websocket-protocol"];if(l&&(l=l.trim().split(/ *, */),(l=this.options.handleProtocols?this.options.handleProtocols(l,r):l[0])&&(u.push("Sec-WebSocket-Protocol: ".concat(l)),f._protocol=l)),t[g.extensionName]){var h=t[g.extensionName].params,d=j(c({},g.extensionName,[h]));u.push("Sec-WebSocket-Extensions: ".concat(d)),f._extensions=t}this.emit("headers",u,r),n.write(u.concat("\r\n").join("\r\n")),n.removeListener("error",T),f.setSocket(n,o,this.options.maxPayload),this.clients&&(this.clients.add(f),f.on("close",(function(){return s.clients.delete(f)}))),i(f,r)}}])&&u(t.prototype,r),n&&u(t,n),s}(y);function N(e){e.emit("close")}function T(){this.destroy()}function q(e,t,r,n){e.writable&&(r=r||b[t],n=a({Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r)},n),e.write("HTTP/1.1 ".concat(t," ").concat(b[t],"\r\n")+Object.keys(n).map((function(e){return"".concat(e,": ").concat(n[e])})).join("\r\n")+"\r\n\r\n"+r)),e.removeListener("error",T),e.destroy()}e.exports=C},4055:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(9983),r(9632),r(5254),r(7493),r(4381),r(8655),r(6785),r(386),r(2518),r(6170),r(2076),r(2794),r(3938),r(2646),r(3920),r(9350),r(7507),r(9718),r(4647),r(8536),r(1714),r(92),r(8390),r(9436);var d=r(8614),p=r(7211),y=r(8605),_=r(1631),m=r(4016),v=r(6417),b=v.randomBytes,g=v.createHash,w=r(8835).URL,x=r(9548),j=r(985),k=r(4880),S=r(7540),O=S.BINARY_TYPES,E=S.EMPTY_BUFFER,P=S.GUID,C=S.kStatusCode,N=S.kWebSocket,T=S.NOOP,q=r(3742),L=q.addEventListener,B=q.removeEventListener,R=r(6497),I=R.format,U=R.parse,M=r(105).toBuffer,D=["CONNECTING","OPEN","CLOSING","CLOSED"],A=[8,13],W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=u(f);function f(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=i.call(this))._binaryType=O[0],n._closeCode=1006,n._closeFrameReceived=!1,n._closeFrameSent=!1,n._closeMessage="",n._closeTimer=null,n._extensions={},n._protocol="",n._readyState=f.CONNECTING,n._receiver=null,n._sender=null,n._socket=null,null!==e?(n._bufferedAmount=0,n._isServer=!1,n._redirects=0,Array.isArray(t)?t=t.join(", "):"object"===s(t)&&null!==t&&(r=t,t=void 0),F(l(n),e,t,r)):n._isServer=!0,n}return t=f,(r=[{key:"binaryType",get:function(){return this._binaryType},set:function(e){O.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}},{key:"bufferedAmount",get:function(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}},{key:"extensions",get:function(){return Object.keys(this._extensions).join()}},{key:"protocol",get:function(){return this._protocol}},{key:"readyState",get:function(){return this._readyState}},{key:"url",get:function(){return this._url}},{key:"setSocket",value:function(e,t,r){var n=new j(this.binaryType,this._extensions,this._isServer,r);this._sender=new k(e,this._extensions),this._receiver=n,this._socket=e,n[N]=this,e[N]=this,n.on("conclude",H),n.on("drain",Z),n.on("error",J),n.on("message",$),n.on("ping",Q),n.on("pong",X),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",ee),e.on("data",te),e.on("end",re),e.on("error",ne),this._readyState=f.OPEN,this.emit("open")}},{key:"emitClose",value:function(){if(!this._socket)return this._readyState=f.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[x.extensionName]&&this._extensions[x.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=f.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}},{key:"close",value:function(e,t){var r=this;if(this.readyState!==f.CLOSED){if(this.readyState===f.CONNECTING)return z(this,this._req,"WebSocket was closed before the connection was established");this.readyState!==f.CLOSING?(this._readyState=f.CLOSING,this._sender.close(e,t,!this._isServer,(function(e){e||(r._closeFrameSent=!0,r._closeFrameReceived&&r._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}},{key:"ping",value:function(e,t,r){if(this.readyState===f.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===f.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||E,t,r)):Y(this,e,r)}},{key:"pong",value:function(e,t,r){if(this.readyState===f.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===f.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||E,t,r)):Y(this,e,r)}},{key:"send",value:function(e,t,r){if(this.readyState===f.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState===f.OPEN){var n=o({binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},t);this._extensions[x.extensionName]||(n.compress=!1),this._sender.send(e||E,n,r)}else Y(this,e,r)}},{key:"terminate",value:function(){if(this.readyState!==f.CLOSED){if(this.readyState===f.CONNECTING)return z(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=f.CLOSING,this._socket.destroy())}}}])&&a(t.prototype,r),n&&a(t,n),f}(d);function F(e,t,r,n){var s,a=o(o({protocolVersion:A[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},n),{},{createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0});if(!A.includes(a.protocolVersion))throw new RangeError("Unsupported protocol version: ".concat(a.protocolVersion," ")+"(supported versions: ".concat(A.join(", "),")"));t instanceof w?(s=t,e._url=t.href):(s=new w(t),e._url=t);var c="ws+unix:"===s.protocol;if(!(s.host||c&&s.pathname))throw new Error("Invalid URL: ".concat(e.url));var u,f="wss:"===s.protocol||"https:"===s.protocol,l=f?443:80,h=b(16).toString("base64"),d=f?p.get:y.get;if(a.createConnection=f?V:G,a.defaultPort=a.defaultPort||l,a.port=s.port||l,a.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,a.headers=o({"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"},a.headers),a.path=s.pathname+s.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(u=new x(!0!==a.perMessageDeflate?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=I(i({},x.extensionName,u.offer()))),r&&(a.headers["Sec-WebSocket-Protocol"]=r),a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin),(s.username||s.password)&&(a.auth="".concat(s.username,":").concat(s.password)),c){var _=a.path.split(":");a.socketPath=_[0],a.path=_[1]}var m=e._req=d(a);a.timeout&&m.on("timeout",(function(){z(e,m,"Opening handshake has timed out")})),m.on("error",(function(t){null===m||m.aborted||(m=e._req=null,e._readyState=W.CLOSING,e.emit("error",t),e.emitClose())})),m.on("response",(function(o){var i=o.headers.location,s=o.statusCode;if(i&&a.followRedirects&&s>=300&&s<400){if(++e._redirects>a.maxRedirects)return void z(e,m,"Maximum redirects exceeded");m.abort();var c=new w(i,t);F(e,c,r,n)}else e.emit("unexpected-response",m,o)||z(e,m,"Unexpected server response: ".concat(o.statusCode))})),m.on("upgrade",(function(t,n,o){if(e.emit("upgrade",t),e.readyState===W.CONNECTING){m=e._req=null;var i=g("sha1").update(h+P).digest("base64");if(t.headers["sec-websocket-accept"]===i){var s,c=t.headers["sec-websocket-protocol"],f=(r||"").split(/, */);if(!r&&c?s="Server sent a subprotocol but none was requested":r&&!c?s="Server sent no subprotocol":c&&!f.includes(c)&&(s="Server sent an invalid subprotocol"),s)z(e,n,s);else{if(c&&(e._protocol=c),u)try{var l=U(t.headers["sec-websocket-extensions"]);l[x.extensionName]&&(u.accept(l[x.extensionName]),e._extensions[x.extensionName]=u)}catch(t){return void z(e,n,"Invalid Sec-WebSocket-Extensions header")}e.setSocket(n,o,a.maxPayload)}}else z(e,n,"Invalid Sec-WebSocket-Accept header")}}))}function G(e){return e.path=e.socketPath,_.connect(e)}function V(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=_.isIP(e.host)?"":e.host),m.connect(e)}function z(e,t,r){e._readyState=W.CLOSING;var n=new Error(r);Error.captureStackTrace(n,z),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function Y(e,t,r){if(t){var n=M(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}r&&r(new Error("WebSocket is not open: readyState ".concat(e.readyState," ")+"(".concat(D[e.readyState],")")))}function H(e,t){var r=this[N];r._socket.removeListener("data",te),r._socket.resume(),r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,1005===e?r.close():r.close(e,t)}function Z(){this[N]._socket.resume()}function J(e){var t=this[N];t._socket.removeListener("data",te),t._readyState=W.CLOSING,t._closeCode=e[C],t.emit("error",e),t._socket.destroy()}function K(){this[N].emitClose()}function $(e){this[N].emit("message",e)}function Q(e){var t=this[N];t.pong(e,!t._isServer,T),t.emit("ping",e)}function X(e){this[N].emit("pong",e)}function ee(){var e=this[N];this.removeListener("close",ee),this.removeListener("end",re),e._readyState=W.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",te),this[N]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",K),e._receiver.on("finish",K))}function te(e){this[N]._receiver.write(e)||this.pause()}function re(){var e=this[N];e._readyState=W.CLOSING,e._receiver.end(),this.end()}function ne(){var e=this[N];this.removeListener("error",ne),this.on("error",T),e&&(e._readyState=W.CLOSING,this.destroy())}D.forEach((function(e,t){var r={enumerable:!0,value:t};Object.defineProperty(W.prototype,e,r),Object.defineProperty(W,e,r)})),["binaryType","bufferedAmount","extensions","protocol","readyState","url"].forEach((function(e){Object.defineProperty(W.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((function(e){Object.defineProperty(W.prototype,"on".concat(e),{configurable:!0,enumerable:!0,get:function(){for(var t=this.listeners(e),r=0;r<t.length;r++)if(t[r]._listener)return t[r]._listener},set:function(t){for(var r=this.listeners(e),n=0;n<r.length;n++)r[n]._listener&&this.removeListener(e,r[n]);this.addEventListener(e,t)}})})),W.prototype.addEventListener=L,W.prototype.removeEventListener=B,e.exports=W},6772:function(e){e.exports=require("bufferutil")},2905:function(e){e.exports=require("core-js/modules/es.array-buffer.constructor.js")},2794:function(e){e.exports=require("core-js/modules/es.array.concat.js")},1714:function(e){e.exports=require("core-js/modules/es.array.filter.js")},389:function(e){e.exports=require("core-js/modules/es.array.find.js")},8282:function(e){e.exports=require("core-js/modules/es.array.from.js")},9632:function(e){e.exports=require("core-js/modules/es.array.includes.js")},946:function(e){e.exports=require("core-js/modules/es.array.index-of.js")},4647:function(e){e.exports=require("core-js/modules/es.array.iterator.js")},9983:function(e){e.exports=require("core-js/modules/es.array.join.js")},720:function(e){e.exports=require("core-js/modules/es.array.map.js")},2518:function(e){e.exports=require("core-js/modules/es.array.slice.js")},4165:function(e){e.exports=require("core-js/modules/es.function.name.js")},7099:function(e){e.exports=require("core-js/modules/es.number.constructor.js")},3204:function(e){e.exports=require("core-js/modules/es.number.is-integer.js")},92:function(e){e.exports=require("core-js/modules/es.object.get-own-property-descriptor.js")},9436:function(e){e.exports=require("core-js/modules/es.object.get-own-property-descriptors.js")},6785:function(e){e.exports=require("core-js/modules/es.object.get-prototype-of.js")},7493:function(e){e.exports=require("core-js/modules/es.object.keys.js")},4381:function(e){e.exports=require("core-js/modules/es.object.to-string.js")},9747:function(e){e.exports=require("core-js/modules/es.reflect.apply.js")},2646:function(e){e.exports=require("core-js/modules/es.reflect.construct.js")},2076:function(e){e.exports=require("core-js/modules/es.regexp.exec.js")},8655:function(e){e.exports=require("core-js/modules/es.regexp.to-string.js")},5538:function(e){e.exports=require("core-js/modules/es.set.js")},5254:function(e){e.exports=require("core-js/modules/es.string.includes.js")},9718:function(e){e.exports=require("core-js/modules/es.string.iterator.js")},5575:function(e){e.exports=require("core-js/modules/es.string.replace.js")},6170:function(e){e.exports=require("core-js/modules/es.string.search.js")},3938:function(e){e.exports=require("core-js/modules/es.string.split.js")},386:function(e){e.exports=require("core-js/modules/es.string.starts-with.js")},8588:function(e){e.exports=require("core-js/modules/es.string.trim.js")},9350:function(e){e.exports=require("core-js/modules/es.symbol.description.js")},7507:function(e){e.exports=require("core-js/modules/es.symbol.iterator.js")},3920:function(e){e.exports=require("core-js/modules/es.symbol.js")},3062:function(e){e.exports=require("core-js/modules/es.typed-array.copy-within.js")},3233:function(e){e.exports=require("core-js/modules/es.typed-array.every.js")},9893:function(e){e.exports=require("core-js/modules/es.typed-array.fill.js")},1792:function(e){e.exports=require("core-js/modules/es.typed-array.filter.js")},8301:function(e){e.exports=require("core-js/modules/es.typed-array.find-index.js")},1487:function(e){e.exports=require("core-js/modules/es.typed-array.find.js")},6233:function(e){e.exports=require("core-js/modules/es.typed-array.for-each.js")},6286:function(e){e.exports=require("core-js/modules/es.typed-array.includes.js")},8886:function(e){e.exports=require("core-js/modules/es.typed-array.index-of.js")},5410:function(e){e.exports=require("core-js/modules/es.typed-array.iterator.js")},7690:function(e){e.exports=require("core-js/modules/es.typed-array.join.js")},2495:function(e){e.exports=require("core-js/modules/es.typed-array.last-index-of.js")},4954:function(e){e.exports=require("core-js/modules/es.typed-array.map.js")},1250:function(e){e.exports=require("core-js/modules/es.typed-array.reduce-right.js")},4260:function(e){e.exports=require("core-js/modules/es.typed-array.reduce.js")},7580:function(e){e.exports=require("core-js/modules/es.typed-array.reverse.js")},9046:function(e){e.exports=require("core-js/modules/es.typed-array.set.js")},7419:function(e){e.exports=require("core-js/modules/es.typed-array.slice.js")},7911:function(e){e.exports=require("core-js/modules/es.typed-array.some.js")},8876:function(e){e.exports=require("core-js/modules/es.typed-array.sort.js")},3925:function(e){e.exports=require("core-js/modules/es.typed-array.subarray.js")},1949:function(e){e.exports=require("core-js/modules/es.typed-array.to-locale-string.js")},6026:function(e){e.exports=require("core-js/modules/es.typed-array.to-string.js")},873:function(e){e.exports=require("core-js/modules/es.typed-array.uint8-array.js")},8390:function(e){e.exports=require("core-js/modules/web.dom-collections.for-each.js")},8536:function(e){e.exports=require("core-js/modules/web.dom-collections.iterator.js")},6417:function(e){e.exports=require("crypto")},334:function(e){e.exports=require("dotenv")},8614:function(e){e.exports=require("events")},2127:function(e){e.exports=require("express")},8605:function(e){e.exports=require("http")},7211:function(e){e.exports=require("https")},1631:function(e){e.exports=require("net")},2413:function(e){e.exports=require("stream")},4016:function(e){e.exports=require("tls")},8835:function(e){e.exports=require("url")},6993:function(e){e.exports=require("utf-8-validate")},8761:function(e){e.exports=require("zlib")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}!function(){var e=r(2127),t=r(8605),n=r(3905),o=require("path"),i=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},s=function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a=new(r(2127).Router);a.get("/route",(function(e,t){return i(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){return setTimeout(e,3e3)}))];case 1:return e.sent(),t.send("es6 syntax tests z promise"),[2]}}))}))}));var c=a;r(334).config();var u=process.env.PORT||8080,f=e();f.use(e.static("./dist")),f.use(c),f.get("*",(function(e,t){t.setHeader("set-cookie",["test=true"]),t.sendFile(o.resolve(__dirname,"./main.html"))}));var l=t.createServer(f),h=new n.Server({server:l}),d=0;h.on("connection",(function(e,t,r){console.log(t),e.on("message",(function(t){var r=JSON.parse(t);"send-message"===r.command?h.clients.forEach((function(t){t!=e&&t.send(JSON.stringify({message:r.message}))})):"get-id"===r.command&&e.send(JSON.stringify({id:"id"+d++}))}))})),l.listen(8080,(function(){console.log("Listening on port "+u)}))}()}();